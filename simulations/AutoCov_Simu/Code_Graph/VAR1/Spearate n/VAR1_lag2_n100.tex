\documentclass{article}
\usepackage{tikz}
\usepackage[active,tightpage,psfixbb]{preview}
\PreviewEnvironment{pgfpicture}
\setlength\PreviewBorder{0pt}
\usepackage{amssymb}
%\definecolor{mygreen}{HTML}{16AF11}
%\definecolor{myred}{HTML}{F16A57}
%\definecolor{myblue}{HTML}{0A71BD}
\usepackage{Sweave}
\begin{document}
\input{VAR1_lag2_n100-concordance}

\begin{Schunk}
\begin{Sinput}
> library(tikzDevice)
> options(tikzMetricPackages = c("\\usepackage[utf8]{inputenc}",
+     "\\usepackage[T1]{fontenc}", "\\usetikzlibrary{calc}",
+     "\\usepackage{amssymb}", "\\usepackage{amsfonts}", "\\usepackage{nicefrac}"))
> tikz("test_fig.tex", width = 8.5, height = 4.5,
+      packages = c("\\usepackage{tikz}",
+                  "\\usepackage[active,tightpage,psfixbb]{preview}",
+                  "\\PreviewEnvironment{pgfpicture}",
+                  "\\setlength\\PreviewBorder{0pt}",
+                  "\\usepackage{amssymb}",
+                  "\\usepackage{amsfonts}",
+                  "\\usepackage{nicefrac}"))
> load("~/GitHub/rcov/simulations/AutoCov_Simu/Data_VAR1_n100/VAR1_n100_lag2_rel.rda")
> table1_n100 <- table7
> table2_n100 <- table8
> table3_n100 <- table9
> ele_mom = cbind(t(table1_n100[c(1,5,9),1:3]), t(table2_n100[c(1,5,9),1:3]), t(table3_n100[c(1,5,9),1:3]),
+                 t(table1_n100[c(1,5,9),4:6]), t(table2_n100[c(1,5,9),4:6]), t(table3_n100[c(1,5,9),4:6]),
+                 t(table1_n100[c(1,5,9),7:9]), t(table2_n100[c(1,5,9),7:9]), t(table3_n100[c(1,5,9),7:9]),
+                 t(table1_n100[c(1,5,9),10:12]), t(table2_n100[c(1,5,9),10:12]), t(table3_n100[c(1,5,9),10:12]))
> ele_T = cbind(t(table1_n100[c(2,6,10),1:3]), t(table2_n100[c(2,6,10),1:3]), t(table3_n100[c(2,6,10),1:3]),
+               t(table1_n100[c(2,6,10),4:6]), t(table2_n100[c(2,6,10),4:6]), t(table3_n100[c(2,6,10),4:6]),
+               t(table1_n100[c(2,6,10),7:9]), t(table2_n100[c(2,6,10),7:9]), t(table3_n100[c(2,6,10),7:9]),
+               t(table1_n100[c(2,6,10),10:12]), t(table2_n100[c(2,6,10),10:12]), t(table3_n100[c(2,6,10),10:12]))
> ele_AH = cbind(t(table1_n100[c(3,7,11),1:3]), t(table2_n100[c(3,7,11),1:3]), t(table3_n100[c(3,7,11),1:3]),
+                t(table1_n100[c(3,7,11),4:6]), t(table2_n100[c(3,7,11),4:6]), t(table3_n100[c(3,7,11),4:6]),
+                t(table1_n100[c(3,7,11),7:9]), t(table2_n100[c(3,7,11),7:9]), t(table3_n100[c(3,7,11),7:9]),
+                t(table1_n100[c(3,7,11),10:12]), t(table2_n100[c(3,7,11),10:12]), t(table3_n100[c(3,7,11),10:12]))
> spe_T = cbind(t(table1_n100[c(4,8,12),1:3]), t(table2_n100[c(4,8,12),1:3]), t(table3_n100[c(4,8,12),1:3]),
+               t(table1_n100[c(4,8,12),4:6]), t(table2_n100[c(4,8,12),4:6]), t(table3_n100[c(4,8,12),4:6]),
+               t(table1_n100[c(4,8,12),7:9]), t(table2_n100[c(4,8,12),7:9]), t(table3_n100[c(4,8,12),7:9]),
+               t(table1_n100[c(4,8,12),10:12]), t(table2_n100[c(4,8,12),10:12]), t(table3_n100[c(4,8,12),10:12]))
> names_lg = c("Element MoM", "Element Truncated", "Element Ada. Huber", "Spectrum Truncated")
> # Names of the distributions (in the order norm, pareto, log-norm, t4)
> names_dist = c("Normal", "Pareto", "Log-Normal", "Student's $t_4$")
> # Some colors
> mygrey = "grey85"
> cols = hcl(h = seq(15, 375, length = 5), l = 65, c = 100, alpha = 1)[1:4]
> par(mfrow = c(3,1), oma = c(4.5,5,2.5,1),
+     mar = c(0,0,0.5,0.5) + 0.1)
> plot(NA, xlim = range(1,36), ylim = c(0.06, 1.34), axes = FALSE, ann = FALSE)
> box()
> axis(2, at = c(0.25, 0.5, 0.75, 1, 1.25), cex = 1, las = 2)
> abline(h = c(0.25, 0.5, 0.75, 1, 1.25), col = mygrey, lty = 3)
> abline(v = 3.5 + 0:3*9, col = mygrey, lty = 3)
> abline(v = 6.5 + 0:3*9, col = mygrey, lty = 3)
> abline(v = 0.5, col = mygrey, lty = 3)
> abline(v = 36.5, col = mygrey, lty = 3)
> abline(v = 9.5 + 0:2*9, lty = 2, col = "grey50")
> mtext("Max norm", side = 2, line = 3.5, cex = 1.15)
> abline(h = 1, lty = 1, col = "grey50")
> mtext(names_dist[1], side = 3, line = 0.5, at = 5)
> mtext(names_dist[2], side = 3, line = 0.5, at = 5+9)
> mtext(names_dist[3], side = 3, line = 0.5, at = 5+9*2)
> mtext(names_dist[4], side = 3, line = 0.5, at = 5+9*3)
> for (i in 1:4){
+   text(2 + 9*(i-1), 1.25, "Diagonal", cex = 0.9)
+   text(5 + 9*(i-1), 1.25, "Equal", cex = 0.9)
+   text(8 + 9*(i-1), 1.25, "Power", cex = 0.9)
+ }
> legend("bottomleft", names_lg,
+        bty = "n", col = cols, pch = 15:18, pt.cex = c(1,1,1,1.25), lwd = 1, cex = 1.1)
> for (i in 1:12){
+   lines(3*(i-1)+1:3, ele_mom[1, 3*(i-1)+1:3], col = cols[1],
+         lwd = 1.5, lty = 1, pch = 15, type= "b")
+   lines(3*(i-1)+1:3, ele_T[1, 3*(i-1)+1:3], col = cols[2],
+         lwd = 1.5, lty = 1, pch = 16, type= "b")
+   lines(3*(i-1)+1:3, ele_AH[1, 3*(i-1)+1:3], col = cols[3],
+         lwd = 1.5, lty = 1, pch = 17, type= "b")
+   lines(3*(i-1)+1:3, spe_T[1, 3*(i-1)+1:3], col = cols[4],
+         lwd = 1.5, lty = 1, pch = 18, type= "b", cex = 1.25)
+ }
> plot(NA, xlim = range(1,36), ylim = c(0.06, 1.34), axes = FALSE, ann = FALSE)
> box()
> axis(2, at = c(0.25, 0.5, 0.75, 1, 1.25), cex = 1, las = 2)
> abline(h = c(0.25, 0.5, 0.75, 1, 1.25), col = mygrey, lty = 3)
> abline(v = 3.5 + 0:3*9, col = mygrey, lty = 3)
> abline(v = 6.5 + 0:3*9, col = mygrey, lty = 3)
> abline(v = 0.5, col = mygrey, lty = 3)
> abline(v = 36.5, col = mygrey, lty = 3)
> abline(v = 9.5 + 0:2*9, lty = 2, col = "grey50")
> mtext("Spectral norm", side = 2, line = 3.5, cex = 1.15)
> abline(h = 1, lty = 1, col = "grey50")
> for (i in 1:4){
+   text(2 + 9*(i-1), 1.25, "Diagonal", cex = 0.9)
+   text(5 + 9*(i-1), 1.25, "Equal", cex = 0.9)
+   text(8 + 9*(i-1), 1.25, "Power", cex = 0.9)
+ }
> for (i in 1:12){
+   lines(3*(i-1)+1:3, ele_mom[2, 3*(i-1)+1:3], col = cols[1],
+         lwd = 1.5, lty = 1, pch = 15, type= "b")
+   lines(3*(i-1)+1:3, ele_T[2, 3*(i-1)+1:3], col = cols[2],
+         lwd = 1.5, lty = 1, pch = 16, type= "b")
+   lines(3*(i-1)+1:3, ele_AH[2, 3*(i-1)+1:3], col = cols[3],
+         lwd = 1.5, lty = 1, pch = 17, type= "b")
+   lines(3*(i-1)+1:3, spe_T[2, 3*(i-1)+1:3], col = cols[4],
+         lwd = 1.5, lty = 1, pch = 18, type= "b", cex = 1.25)
+ }
> plot(NA, xlim = range(1,36), ylim = c(0.06, 1.34), axes = FALSE, ann = FALSE)
> box()
> axis(2, at = c(0.25, 0.5, 0.75, 1, 1.25), cex = 1, las = 2)
> abline(h = c(0.25, 0.5, 0.75, 1, 1.25), col = mygrey, lty = 3)
> abline(v = 3.5 + 0:3*9, col = mygrey, lty = 3)
> abline(v = 6.5 + 0:3*9, col = mygrey, lty = 3)
> abline(v = 0.5, col = mygrey, lty = 3)
> abline(v = 36.5, col = mygrey, lty = 3)
> abline(v = 9.5 + 0:2*9, lty = 2, col = "grey50")
> mtext("Frobenius norm", side = 2, line = 3.5, cex = 1.15)
> abline(h = 1, lty = 1, col = "grey50")
> for (i in 1:4){
+   text(2 + 9*(i-1), 1.25, "Diagonal", cex = 0.9)
+   text(5 + 9*(i-1), 1.25, "Equal", cex = 0.9)
+   text(8 + 9*(i-1), 1.25, "Power", cex = 0.9)
+ }
> for (i in 1:12){
+   lines(3*(i-1)+1:3, ele_mom[3, 3*(i-1)+1:3], col = cols[1],
+         lwd = 1.5, lty = 1, pch = 15, type= "b")
+   lines(3*(i-1)+1:3, ele_T[3, 3*(i-1)+1:3], col = cols[2],
+         lwd = 1.5, lty = 1, pch = 16, type= "b")
+   lines(3*(i-1)+1:3, ele_AH[3, 3*(i-1)+1:3], col = cols[3],
+         lwd = 1.5, lty = 1, pch = 17, type= "b")
+   lines(3*(i-1)+1:3, spe_T[3, 3*(i-1)+1:3], col = cols[4],
+         lwd = 1.5, lty = 1, pch = 18, type= "b", cex = 1.25)
+ }
> axis(1, rep(c(50, 100, 150), 12), at = 1:36, cex = 0.75, cex.axis = 0.85)
> mtext("Dimension $d$", side = 1, line = 3, cex = 1)
> dev.off()
\end{Sinput}
\begin{Soutput}
null device 
          1 
\end{Soutput}
\end{Schunk}

\begin{figure}
\input{test_fig.tex}
\end{figure}

\end{document}
