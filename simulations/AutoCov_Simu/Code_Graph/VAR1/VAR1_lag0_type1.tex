\documentclass{article}
\usepackage{tikz}
\usepackage[active,tightpage,psfixbb]{preview}
\PreviewEnvironment{pgfpicture}
\setlength\PreviewBorder{0pt}
\usepackage{amssymb}
%\definecolor{mygreen}{HTML}{16AF11}
%\definecolor{myred}{HTML}{F16A57}
%\definecolor{myblue}{HTML}{0A71BD}
\usepackage{Sweave}
\begin{document}
\input{VAR1_lag0_type1-concordance}

\begin{Schunk}
\begin{Sinput}
> # Names for legend (in the order ele_mom, ele_T, ele_AH, spe_T)
> names_lg = c("Element MoM", "Element Truncated", "Element Ada. Huber", "Spectrum Truncated")
> # Names of the distributions (in the order norm, pareto, log-norm, t4)
> names_dist = c("Normal", "Pareto", "Log-Normal", "Student's $t_4$")
> # Some colors
> mygrey = "grey85"
> cols = hcl(h = seq(15, 375, length = 5), l = 65, c = 100, alpha = 1)[1:4]
> make_graph = function(ele_mom, ele_T, ele_AH, spe_T, names_lg, names_dist, cols, mygrey){
+   par(mfrow = c(3,1), oma = c(4.5,5,2.5,1),
+       mar = c(0,0,0.5,0.5) + 0.1)
+ 
+   plot(NA, xlim = range(1,24), ylim = c(0.06, 1.34), axes = FALSE, ann = FALSE)
+   box()
+   axis(2, at = c(0.25, 0.5, 0.75, 1, 1.25), cex.axis = 1.2, las = 2)
+ 
+   abline(h = c(0.25, 0.5, 0.75, 1, 1.25), col = mygrey, lty = 3)
+   abline(v = 3.5 + 0:3*6, col = mygrey, lty = 3)
+   abline(v = 6.5 + 0:2*6, lty = 2, col = "grey50")
+   mtext("Max norm", side = 2, line = 3.5, cex = 1.15)
+   abline(h = 1, lty = 1, col = "grey50")
+   mtext(names_dist[1], side = 3, line = 0.5, at = 3.5)
+   mtext(names_dist[2], side = 3, line = 0.5, at = 3.5+6)
+   mtext(names_dist[3], side = 3, line = 0.5, at = 3.5+6*2)
+   mtext(names_dist[4], side = 3, line = 0.5, at = 3.5+6*3)
+ 
+   for (i in 1:4){
+     text(2 + 6*(i-1), 1.25, "n = 50", cex = 1.5)
+     text(5 + 6*(i-1), 1.25, "n = 100", cex = 1.5)
+   }
+ 
+   legend("bottomleft", names_lg,
+          bty = "n", col = cols, pch = 15:18, pt.cex = c(1,1,1,1.25), lwd = 1, cex = 1.1)
+ 
+   for (i in 1:8){
+     lines(3*(i-1)+1:3, ele_mom[1, 3*(i-1)+1:3], col = cols[1],
+           lwd = 1.5, lty = 1, pch = 15, type= "b")
+     lines(3*(i-1)+1:3, ele_T[1, 3*(i-1)+1:3], col = cols[2],
+           lwd = 1.5, lty = 1, pch = 16, type= "b")
+     lines(3*(i-1)+1:3, ele_AH[1, 3*(i-1)+1:3], col = cols[3],
+           lwd = 1.5, lty = 1, pch = 17, type= "b")
+     lines(3*(i-1)+1:3, spe_T[1, 3*(i-1)+1:3], col = cols[4],
+           lwd = 1.5, lty = 1, pch = 18, type= "b", cex = 1.25)
+   }
+ 
+   plot(NA, xlim = range(1,24), ylim = c(0.06, 1.34), axes = FALSE, ann = FALSE)
+   box()
+   axis(2, at = c(0.25, 0.5, 0.75, 1, 1.25), cex.axis = 1.2, las = 2)
+ 
+   abline(h = c(0.25, 0.5, 0.75, 1, 1.25), col = mygrey, lty = 3)
+   abline(v = 3.5 + 0:3*6, col = mygrey, lty = 3)
+   abline(v = 6.5 + 0:2*6, lty = 2, col = "grey50")
+   mtext("Spectral norm", side = 2, line = 3.5, cex = 1.15)
+   abline(h = 1, lty = 1, col = "grey50")
+ 
+   for (i in 1:4){
+     text(2 + 6*(i-1), 1.25, "n = 50", cex = 1.5)
+     text(5 + 6*(i-1), 1.25, "n = 100", cex = 1.5)
+   }
+ 
+   for (i in 1:8){
+     lines(3*(i-1)+1:3, ele_mom[2, 3*(i-1)+1:3], col = cols[1],
+           lwd = 1.5, lty = 1, pch = 15, type= "b")
+     lines(3*(i-1)+1:3, ele_T[2, 3*(i-1)+1:3], col = cols[2],
+           lwd = 1.5, lty = 1, pch = 16, type= "b")
+     lines(3*(i-1)+1:3, ele_AH[2, 3*(i-1)+1:3], col = cols[3],
+           lwd = 1.5, lty = 1, pch = 17, type= "b")
+     lines(3*(i-1)+1:3, spe_T[2, 3*(i-1)+1:3], col = cols[4],
+           lwd = 1.5, lty = 1, pch = 18, type= "b", cex = 1.25)
+   }
+ 
+   plot(NA, xlim = range(1,24), ylim = c(0.06, 1.34), axes = FALSE, ann = FALSE)
+   box()
+   axis(2, at = c(0.25, 0.5, 0.75, 1, 1.25), cex.axis = 1.2, las = 2)
+ 
+   abline(h = c(0.25, 0.5, 0.75, 1, 1.25), col = mygrey, lty = 3)
+   abline(v = 3.5 + 0:3*6, col = mygrey, lty = 3)
+   abline(v = 6.5 + 0:2*6, lty = 2, col = "grey50")
+   mtext("Frobenius norm", side = 2, line = 3.5, cex = 1.15)
+   abline(h = 1, lty = 1, col = "grey50")
+ 
+   for (i in 1:4){
+     text(2 + 6*(i-1), 1.25, "n = 50", cex = 1.5)
+     text(5 + 6*(i-1), 1.25, "n = 100", cex = 1.5)
+   }
+ 
+   for (i in 1:8){
+     lines(3*(i-1)+1:3, ele_mom[3, 3*(i-1)+1:3], col = cols[1],
+           lwd = 1.5, lty = 1, pch = 15, type= "b")
+     lines(3*(i-1)+1:3, ele_T[3, 3*(i-1)+1:3], col = cols[2],
+           lwd = 1.5, lty = 1, pch = 16, type= "b")
+     lines(3*(i-1)+1:3, ele_AH[3, 3*(i-1)+1:3], col = cols[3],
+           lwd = 1.5, lty = 1, pch = 17, type= "b")
+     lines(3*(i-1)+1:3, spe_T[3, 3*(i-1)+1:3], col = cols[4],
+           lwd = 1.5, lty = 1, pch = 18, type= "b", cex = 1.25)
+   }
+ 
+   axis(1, rep(c(50, 100, 150), 8), at = 1:24, cex.axis = 1)
+   mtext("Dimension $d$", side = 1, line = 3, cex = 1)
+ }
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> load("~/GitHub/rcov/simulations/AutoCov_Simu/Data_VAR1_n50/VAR1_n50_lag0_rel.rda")
> table1_n50 <- table1
> table2_n50 <- table2
> table3_n50 <- table3
> load("~/GitHub/rcov/simulations/AutoCov_Simu/Data_VAR1_n100/VAR1_n100_lag0_rel.rda")
> table1_n100 <- table1
> table2_n100 <- table2
> table3_n100 <- table3
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> library(tikzDevice)
> options(tikzMetricPackages = c("\\usepackage[utf8]{inputenc}",
+     "\\usepackage[T1]{fontenc}", "\\usetikzlibrary{calc}",
+     "\\usepackage{amssymb}", "\\usepackage{amsfonts}", "\\usepackage{nicefrac}"))
> tikz("var1_autocov_fig1.tex", width = 6.5, height = 4.5,
+      packages = c("\\usepackage{tikz}",
+                  "\\usepackage[active,tightpage,psfixbb]{preview}",
+                  "\\PreviewEnvironment{pgfpicture}",
+                  "\\setlength\\PreviewBorder{0pt}",
+                  "\\usepackage{amssymb}",
+                  "\\usepackage{amsfonts}",
+                  "\\usepackage{nicefrac}"))
> # Inputs: 4 matrices, i.e. ele_mom, ele_T, ele_AH, spe_T, each of dimension 24 x 3.
> # Each matrix is construct as follows:
> #                normal; p = 50; n = 50 | normal; p = 100; n = 50 | ... | t4; p = 150; n = 100 |
> # Max norm      |            x          |         x               | ... |         x            |
> # Spectral norm |            x          |         x               | ... |         x            |
> # Frobenius norm|            x          |         x               | ... |         x            |
> ele_mom = cbind(t(table1_n50[c(1,5,9),1:3]), t(table1_n100[c(1,5,9),1:3]), t(table1_n50[c(1,5,9),4:6]), t(table1_n100[c(1,5,9),4:6]), t(table1_n50[c(1,5,9),7:9]), t(table1_n100[c(1,5,9),7:9]), t(table1_n50[c(1,5,9),10:12]), t(table1_n100[c(1,5,9),10:12]))#matrix(rep(1, 24*3) - runif(24*3), 3, 24)
> ele_T = cbind(t(table1_n50[c(2,6,10),1:3]), t(table1_n100[c(2,6,10),1:3]), t(table1_n50[c(2,6,10),4:6]), t(table1_n100[c(2,6,10),4:6]), t(table1_n50[c(2,6,10),7:9]), t(table1_n100[c(2,6,10),7:9]), t(table1_n50[c(2,6,10),10:12]), t(table1_n100[c(2,6,10),10:12]))#matrix(rep(1, 24*3) - runif(24*3), 3, 24)
> ele_AH = cbind(t(table1_n50[c(3,7,11),1:3]), t(table1_n100[c(3,7,11),1:3]), t(table1_n50[c(3,7,11),4:6]), t(table1_n100[c(3,7,11),4:6]), t(table1_n50[c(3,7,11),7:9]), t(table1_n100[c(3,7,11),7:9]), t(table1_n50[c(3,7,11),10:12]), t(table1_n100[c(3,7,11),10:12]))#matrix(rep(1, 24*3) - runif(24*3), 3, 24)
> spe_T = cbind(t(table1_n50[c(4,8,12),1:3]), t(table1_n100[c(4,8,12),1:3]), t(table1_n50[c(4,8,12),4:6]), t(table1_n100[c(4,8,12),4:6]), t(table1_n50[c(4,8,12),7:9]), t(table1_n100[c(4,8,12),7:9]), t(table1_n50[c(4,8,12),10:12]), t(table1_n100[c(4,8,12),10:12]))#matrix(rep(1, 24*3) - runif(24*3), 3, 24)
> make_graph(ele_mom = ele_mom,
+            ele_T = ele_T,
+            ele_AH = ele_AH,
+            spe_T = spe_T,
+            names_lg = names_lg,
+            names_dist = names_dist,
+            cols = cols,
+            mygrey = mygrey)
> dev.off()
\end{Sinput}
\begin{Soutput}
null device 
          1 
\end{Soutput}
\end{Schunk}

\begin{figure}
\input{var1_autocov_fig1.tex}
\end{figure}

\end{document}
